<%= render 'search_header' %>
<div class="col-lg-12 mt-8">
  <div class="card mt-3">
    <div class="card-body">
      <div class="row mt-3">
        <div class="col-sm-6">
          <h4 class="mb-3"><%= @apartment.title %><br> Available by: <%= @apartment.departure_date_availabilty %></h4>
          <div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
            <div class="carousel-inner" role="listbox">
              <!-- Image box start -->
              <% @apartment.images.each do |image| %>
                <div class="carousel-item <%= @apartment.active_class(image) %>">
                  <%= image_tag url_for(image), class: "d-block w-100", style:"width:500px; height:360px;" %>
                </div>
              <% end %>
            </div>
            <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
              <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
              <span class="carousel-control-next-icon" aria-hidden="true"></span>
              <span class="sr-only">Next</span>
            </a>
          </div>
          <p><%= t('apartment.virtual_visit_link') %>: <a href="<%= @apartment.virtual_visit_link %>"><%= @apartment.virtual_visit_link %></a></p>
          <!-- Apartment details start -->
          <div class="row">
            <div class="col-lg-12 mt-5">
              <div class="card">
                <div class="card-body">
                  <div class="media mb-5">
                    <div class="media-body">
                      <p><%= t('apartment.shower_room') %>: <%= @apartment.shower_room %></p>
                      <p><%= t('apartment.floor') %>: <%= @apartment.floor %></p>
                      <p><%= t('apartment.total_bedrooms') %>: <%= @apartment.total_bedrooms %></p>
                      <p><%= t('apartment.area') %>: <%= @apartment.area %></p>
                      <p><%= t('apartment.distance_from_university') %>: <%= @apartment.distance_from_university %></p>
                      <p><%= t('apartment.description') %>: <%= @apartment.description %></p>
                      <p><%= t('apartment.other_facilities') %>: <%= @apartment.other_facilities %></p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- Apartment details end -->
        </div>
        <div class="col-sm-6">
          <!-- Apartment operations buttons start -->
          <div class='action-buttons mb3'>
            <%= link_to 'Back', apartments_path, class: 'btn btn-dark mt-4 pr-4 pl-4' %>
            <% if current_user&.administrative_role? %>
              <%= link_to 'Edit', edit_apartment_path(@apartment), class: 'btn btn-success mt-4 pr-4 pl-4' %>
              <%= link_to  apartment_path(@apartment), method: :delete, data: { confirm: t('confirmation') }, class: 'btn btn-danger mt-4 pr-4 pl-4' do %>Delete
              <% end %>
            <% else %>
              <%= link_to 'Book Now', new_booking_path(apartment_id: @apartment&.id), remote: true, class:"btn btn-success mt-4 pr-4 pl-4" %>
            <% end %>
          </div>
          <!-- Apartment operations buttons end -->
          <!-- Map container start -->
          <div id="map"></div>
          <!-- Map container end -->
          <!-- Rent details start -->
          <p><%= t('apartment.rent_details') %>:
          <ul>
            <% rent = @apartment.rent_rate %>
            <li><%= t('rent.net_rate') %>: <%= rent&.net_rate %></li>
            <li><%= t('rent.water_charge') %>: <%= rent&.water_charge %></li>
            <li><%= t('rent.heating_charge') %>: <%= rent&.heating_charge %></li>
            <li><%= t('rent.electricity_charge') %>: <%= rent&.electricity_charge %></li>
            <li><%= t('rent.internet_charge') %>: <%= rent&.internet_charge %></li>
            <li><%= t('rent.insurance_charge') %>: <%= rent&.insurance_charge %></li>
            <li><%= t('rent.deposit_amount') %>: <%= rent&.deposit_amount %></li>
          </ul><br>
          <!-- Rent details end -->
          <!-- Send inquiry to the landlord button -->
          <%= render '/inquiries/inquiry_button' %>
        </div>
      </div>
    </div>
  </div>
  <!-- Inquiry modal -->
  <%= render '/shared/modal_window', locals: { modelId: 'inuiryModal' } %>
</div>
<!-- Booking form modal -->
<%= render '/shared/modal_window', locals: { modelId: 'booking_modal' } %>
<!-- Similar apartments -->
<%= render 'similar_apartments' %>
<script>
  // Set coordinates and pass to the map
  var myLatLng = [
    [ '100.00',
      "<%= url_for(@apartment.images.first) %>",
      "<%= @apartment.latitude %>",
      "<%= @apartment.longitude %>" ]
  ];
  function initMap() {
    DisplayMap.mapSettings(myLatLng);
  }
</script>
